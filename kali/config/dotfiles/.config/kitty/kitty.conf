# ============================================================================
# KITTY TERMINAL CONFIGURATION
# ============================================================================

# Enable shell integration for enhanced features (command tracking, etc.)
shell_integration enabled

# ============================================================================
# PERFORMANCE OPTIMIZATION
# ============================================================================
# Lower repaint delay for smoother rendering (default: 10ms)
repaint_delay 10

# Reduce input lag for better responsiveness (default: 3ms)
input_delay 3

# Sync screen redraws to monitor refresh rate
sync_to_monitor yes

# ============================================================================
# CURSOR SETTINGS
# ============================================================================
# Number of past cursor positions to trail (visual effect)
cursor_trail 3

# How quickly cursor trail fades (start_opacity end_opacity)
cursor_trail_decay 0.1 0.4

# ============================================================================
# WINDOW APPEARANCE
# ============================================================================
# Thin 1-point border around windows
window_border_width 1pt

# Use minimal border style (no thick decorations)
draw_minimal_borders yes

# Hide OS window decorations (title bar, etc.)
hide_window_decorations yes

# Border colors for focused/unfocused windows
active_border_color #00ff00  
inactive_border_color #282828

# ============================================================================
# WINDOW SIZING & BEHAVIOR
# ============================================================================
# Don't remember previous window size
remember_window_size no

# Default window dimensions (for quake-style terminal)
initial_window_width 800
initial_window_height 500

# Start in windowed mode (not fullscreen)
startup_mode windowed

# Spacing around window content
window_margin_width 5
single_window_margin_width 0
window_padding_width 2

# Dim inactive window text to 70% opacity
inactive_text_alpha 0.7

# ============================================================================
# TILING LAYOUTS
# ============================================================================
# Enable multiple tiling layouts for cycling and advanced window management
enabled_layouts splits,stack,tall,fat,grid,horizontal,vertical

# ============================================================================
# TRANSPARENCY & BLUR
# ============================================================================
# Make background 95% opaque (5% transparent)
background_opacity 0.95

# Dim opacity for inactive content
dim_opacity 0.90

# Apply slight blur to background
background_blur 1

# ============================================================================
# FONTS
# ============================================================================
# Primary font family
font_family      Hack Nerd Font
bold_font        auto
italic_font      auto
bold_italic_font auto

# Base font size
font_size 13.0

# Keep ligatures enabled for programming fonts
disable_ligatures never

# Font size adjustment keybindings
map ctrl+equal  change_font_size all +2.0
map ctrl+minus  change_font_size all -2.0
map cmd+0       change_font_size all 0

# ============================================================================
# URL HANDLING
# ============================================================================
# Underline URLs with curly style
url_style curly

# Open URLs with default system browser
open_url_with default

# Recognize these URL schemes
url_prefixes file ftp ftps gemini git gopher http https irc ircs kitty mailto news sftp ssh

# Enable automatic URL detection
detect_urls yes

# Allow clickable hyperlinks
allow_hyperlinks yes

# Open URL hints with keyboard shortcut (using existing kitty_mod if defined)
map ctrl+shift+u open_url_with_hints

# ============================================================================
# THEME & COLORS
# ============================================================================
# Main theme (Catppuccin Mocha)
include current-theme.conf

# Additional theme includes (commented out)
# include tabs.conf

# ============================================================================
# TAB BAR CONFIGURATION
# ============================================================================
tab_bar_edge top
tab_bar_margin_width 1.0
tab_bar_margin_height 1.0 0.5
tab_bar_style powerline
tab_powerline_style angled
tab_title_template "{index}: {title}"

# Workspace naming (tab titles)
active_tab_title_template "[{index}: {title}]"
tab_fade 0.25 0.5 0.75 1

# styling tabs
active_tab_font_style bold-italic
inactive_tab_font_style normal

# ============================================================================
# TAB NAVIGATION KEYBINDINGS (PRIORITIZING EXISTING)
# ============================================================================
# Switch to specific tab by number
map alt+1 goto_tab 1
map alt+2 goto_tab 2
map alt+3 goto_tab 3
map alt+4 goto_tab 4
map alt+5 goto_tab 5
map alt+6 goto_tab 6
map alt+7 goto_tab 7
map alt+8 goto_tab 8
map alt+9 goto_tab 9
map alt+0 goto_tab 10

# Cycle through tabs (preserving existing)
map ctrl+tab next_tab
map ctrl+shift+tab previous_tab

# Create and close tabs (preserving existing)
map ctrl+t new_tab
map ctrl+shift+w close_tab

# Reorder tabs (preserving existing)
map ctrl+shift+page_up move_tab_backward
map ctrl+shift+page_down move_tab_forward

# New tab/window with current directory (alternative for new feature)
map ctrl+shift+n new_tab_with_cwd
map ctrl+shift+enter new_window_with_cwd  # Preserving existing

# ============================================================================
# WINDOW/PANE MANAGEMENT (INTEGRATED)
# ============================================================================
# Create new panes (splits) - preserving existing
map alt+- launch --cwd=current --location=hsplit
map alt+\ launch --cwd=current --location=vsplit

# Navigate between panes - preserving existing
map alt+h neighboring_window left
map alt+l neighboring_window right
map alt+k neighboring_window up
map alt+j neighboring_window down

# Resize panes - preserving existing
map alt+shift+k resize_window taller
map alt+shift+j resize_window shorter 3
map alt+shift+h resize_window wider
map alt+shift+l resize_window narrower

# Move the currently in focus window - preserving existing
map shift+ctrl+alt+k move_window up
map shift+ctrl+alt+h move_window left
map shift+ctrl+alt+l move_window right
map shift+ctrl+alt+j move_window down

# ============================================================================
# ADVANCED WINDOW MANAGEMENT
# ============================================================================

# Window closing and detaching
map ctrl+shift+q close_window
map ctrl+shift+x detach_window

# Alternative window navigation (arrow keys)
map ctrl+shift+down neighboring_window down
map ctrl+shift+up neighboring_window up
map ctrl+shift+left neighboring_window left
map ctrl+shift+right neighboring_window right

# Layout cycling and management
map f11 toggle_fullscreen
map ctrl+shift+f next_layout
map ctrl+shift+d previous_layout

# Direct layout selection
map ctrl+shift+alt+t goto_layout tall
map ctrl+shift+alt+s goto_layout stack
map ctrl+shift+alt+f goto_layout fat
map ctrl+shift+alt+g goto_layout grid
map ctrl+shift+alt+h goto_layout horizontal
map ctrl+shift+alt+v goto_layout vertical
map ctrl+shift+alt+p goto_layout splits

# Interactive window resizing
map ctrl+shift+r start_resizing_window

# Coarse window resizing (larger increments)
map ctrl+shift+alt+down resize_window taller 10
map ctrl+shift+alt+up resize_window shorter 10
map ctrl+shift+alt+left resize_window narrower 10
map ctrl+shift+alt+right resize_window wider 10

# Window movement to edges
map ctrl+shift+m move_window_to_top
map ctrl+shift+, move_window_forward
map ctrl+shift+. move_window_backward

# Layout actions
map ctrl+shift+e reset_window_sizes
map ctrl+shift+space toggle_layout stack
map ctrl+alt+space layout_action rotate
map ctrl+alt+shift+space layout_action mirror toggle
map ctrl+alt+m layout_action mirror true
map ctrl+alt+b layout_action bias 50 50

# Move windows to screen edges (for splits layout)
map ctrl+shift+alt+left layout_action move_to_screen_edge left
map ctrl+shift+alt+right layout_action move_to_screen_edge right
map ctrl+shift+alt+up layout_action move_to_screen_edge top
map ctrl+shift+alt+down layout_action move_to_screen_edge bottom

# ============================================================================
# STACK LAYOUT SPECIFIC
# ============================================================================
# When using stack layout, these commands help manage the stack
map ctrl+shift+equal focus_visible_window
map ctrl+shift+minus nth_window -1

# ============================================================================
# MONITOR/OS WINDOW MANAGEMENT
# ============================================================================
# Create new OS window (separate terminal window)
map ctrl+shift+alt+n new_os_window

# Move between OS windows
map ctrl+shift+alt+] next_os_window
map ctrl+shift+alt+[ previous_os_window

# Close current OS window
map ctrl+shift+alt+w close_os_window

# ============================================================================
# MARKS AND JUMPING
# ============================================================================
# # Create marks to quickly jump between windows
# map ctrl+shift+; create_marker
# map ctrl+shift+a remove_marker
#
# # Scroll to marks
# map ctrl+shift+up scroll_to_mark prev
# map ctrl+shift+down scroll_to_mark next

# ============================================================================
# WINDOW VISIBILITY AND FOCUS
# ============================================================================
# Swap focused window with another
map ctrl+shift+alt+space swap_with_window

# Focus specific window by number (when you have multiple windows)
map ctrl+1 first_window
map ctrl+2 second_window
map ctrl+3 third_window
map ctrl+4 fourth_window
map ctrl+5 fifth_window
map ctrl+6 sixth_window
map ctrl+7 seventh_window
map ctrl+8 eighth_window
map ctrl+9 ninth_window
map ctrl+0 tenth_window

# ============================================================================
# BROADCAST KITTEN
# ============================================================================
# Send input to multiple panes
map ctrl+shift+b kitten broadcast

# ============================================================================
# REMOTE CONTROL
# ============================================================================
# Enable remote control for scripting and automation
allow_remote_control yes

# Unix socket for remote control
listen_on unix:/tmp/kitty

# ============================================================================
# KITTY SCROLLBACK NVIM CONTROL
# ============================================================================

# kitty-scrollback.nvim Kitten alias
action_alias kitty_scrollback_nvim kitten $HOME/.local/share/nvim/lazy/kitty-scrollback.nvim/python/kitty_scrollback_nvim.py

# Browse scrollback buffer in nvim
map ctrl+shift+h kitty_scrollback_nvim

# Browse output of the last shell command in nvim
map ctrl+shift+g kitty_scrollback_nvim --config ksb_builtin_last_cmd_output

# Show clicked command output in nvim
mouse_map ctrl+shift+right press ungrabbed combine : mouse_select_command_output : kitty_scrollback_nvim --config ksb_builtin_last_visited_cmd_output

# ============================================================================
# CONFIGURATION MANAGEMENT
# ============================================================================
# Reload configuration file
map ctrl+alt+r load_config_file

# Edit config file in default editor
map ctrl+shift+alt+comma edit_config_file

# Debug configuration
map ctrl+shift+alt+d debug_config

# ============================================================================
# MOUSE SUPPORT
# ============================================================================
# Mouse-based window management
mouse_map left click ungrabbed mouse_click_url_or_select
mouse_map left doublepress ungrabbed mouse_selection word
mouse_map left triplepress ungrabbed mouse_selection line
mouse_map middle press ungrabbed paste_from_selection
mouse_map right press ungrabbed show_command_output

# Window resizing with mouse
mouse_map left click grabbed mouse_handle_click release
mouse_map left press grabbed mouse_handle_click

# Window movement with mouse (drag with ctrl+shift)
mouse_map ctrl+shift+left press grabbed discard_event
mouse_map ctrl+shift+left drag grabbed mouse_move_window

# ============================================================================
# CLIPBOARD
# ============================================================================
# Copy to clipboard
map ctrl+shift+c copy_to_clipboard
map ctrl+shift+v paste_from_clipboard
map shift+insert paste_from_clipboard

# Copy to buffer
map ctrl+shift+alt+c copy_to_buffer a
map ctrl+shift+alt+v paste_from_buffer a

# ============================================================================
# SCROLLING
# ============================================================================
# Scroll up/down by line
map ctrl+shift+page_up scroll_line_up
map ctrl+shift+page_down scroll_line_down

# Scroll up/down by page
map ctrl+shift+home scroll_home
map ctrl+shift+end scroll_end

# Scroll to top/bottom
map ctrl+alt+home scroll_to_prompt -1
map ctrl+alt+end scroll_to_prompt 1

# ============================================================================
# MISCELLANEOUS
# ============================================================================
# Clear screen and scrollback
map ctrl+shift+delete clear_terminal reset active

# Show/hide kitty shell
map ctrl+shift+escape kitty_shell window

# Unicode input
map ctrl+shift+u kitten unicode_input

# Open selected path
map ctrl+shift+o open_selected_path

# Signal handling
map ctrl+shift+backspace send_signal SIGINT
